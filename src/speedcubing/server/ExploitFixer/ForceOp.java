package speedcubing.server.ExploitFixer;

import speedcubing.server.speedcubingServer;
import org.bukkit.Bukkit;
import org.bukkit.entity.Player;
import org.bukkit.event.Listener;

import java.util.Timer;
import java.util.TimerTask;
import java.util.UUID;

public class ForceOp implements Listener {
    public static boolean AllowOP(UUID uuid) {
        return speedcubingServer.connection.selectBoolean("playersdata", "allow_op", "uuid='" + uuid + "'");
    }

    public void run() {
        new Timer().schedule(new TimerTask() {
            @Override
            public void run() {
                for (Player p : Bukkit.getOnlinePlayers()) {
                    if (p.isOp())
                        if (!speedcubingServer.connection.selectBoolean("playersdata", "allow_op", "uuid='" + p.getUniqueId() + "'"))
                            Bukkit.getScheduler().runTask(speedcubingServer.getPlugin(speedcubingServer.class), () ->
                                    p.kickPlayer(""));
                }
            }
        }, 0, 1000);
    }
}
